# REST API Server for {{appName}}

## Overview

This CloudI API service was generated by the [OpenAPI Generator](https://openapi-generator.tech) project.
It uses the [CloudI](https://github.com/CloudI/cloudi) Framework.

## Mandatory Models

Your API design MUST describe Error in `#/components/schemas`:

```
Error:
  $ref: ../common/error.yml
```

- error.yml
```
---
description: ""
required:
- errors
type: object
properties:
  errors:
    description: ""
    type: array
    items:
      $ref: '#/ErrorItem'

ErrorItem:
  description: ""
  required:
  - detail
  - title
  - code
  type: object
  properties:
    code:
      description: ""
      type: integer
    title:
      description: ""
      type: string
    detail:
      description: ""
      type: string
    source:
      description: ""
      type: string
```

## Files organization

The CloudI C++ REST service generator creates three folders:

- `api`: This folder contains the handlers for each method specified in the OpenAPI definition. Every handler extracts
the path and body parameters (if any) from the requests and tries to parse and possibly validate them.
Once this step is completed, the main API class calls the corresponding abstract method that should be implemented
by the developer (a basic implementation is provided under the `impl` folder)

- `impl`: As written above, the implementation folder contains, for each API, the corresponding implementation class,
which extends the main API class and implements the abstract methods.
Every method receives the path and body parameters as constant reference variables and a reference to the response
object, that should be filled with the right response and sent at the end of the method with the command:
api.return_(request_type, name, pattern, "", 0, response, response_size, timeout, trans_id, pid, pid_size);

- `model`: This folder contains the corresponding class for every object schema found in the OpenAPI specification.

The main folder contains also a file with a main that can be used to start the server.
Of course, is you should customize this file based on your needs

## Installation

First of all, you need to download and install the libraries listed [here](#libraries-required).

Once the libraries are installed, in order to compile and run the server please follow the steps below:

```bash
mkdir build
cd build
cmake ..
make
```

Once compiled run the server:

```bash
cd build
curl -X POST -d @../priv/cloudi/cloudi.conf http://localhost:6464/cloudi/api/rpc/services_add.erl
```

## Libraries required
- [CloudI](http://cloudi.org)
- [JSON for Modern C++](https://github.com/nlohmann/json/#integration): Please download the `json.hpp` file and
put it under the model/nlohmann folder

## Namespaces
{{{apiPackage}}}
{{{modelPackage}}}
{{{packageName}}}
